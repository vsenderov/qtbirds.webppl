# README.md

The json chunks need to be extracted with `tools/json-extractor.js`.

## Sprint 6

### Exp 6.1

#### 2023-03-14 RESEARCH LOG

We are going to use a fairly simple bifurcating tree, generated by Bing, bing_small.phyjson:

  -------10 Mya
   /\
  /  \
  -------present

We will also have a single nucleotide

params\single-nuc.fasta

And only two colors: black and white

colors2.json

We use the Mk-model for character evolution

Q\mk-2state.json

For the nucleotide evolution we will use the JC model

Q\jc69.json

We want two rate regimes:

a. one rate regime that has very low "nu" (independent evolution)

```json exp6.1-rates-a
{
  "lam": 0.1,
  "mu": 0.1,
  "nu": 0.0,
} 
```

b. one rate regime that where evolution happens perfectly correlated

```json exp6.1-rates-b
{
  "lam": 0.0,
  "mu": 0.0,
  "nu": 0.1,
} 
```

node tools/json-extractor.js experiments/README.md

webppl qtbirds-sim.wppl --require fasta2json --require . --require webppl-fs --require phyjs --  params/single-nuc.fasta trees/bing_small.phyjson experiments/exp6.1-rates-a.json params/colors2.json Q/jc69.json Q/mk-2state.json > independently_evolution.json

webppl qtbirds-sim.wppl --require fasta2json --require . --require webppl-fs --require phyjs --  params/single-nuc.fasta trees/bing_small.phyjson experiments/exp6.1-rates-b.json params/colors2.json Q/jc69.json Q/mk-2state.json > correlated_evolution.json

Use the joint_dists.R in tools result in exactly equal marginal distributions but different joint distributions


        black   white     Sum
  a   0.19207 0.25443 0.44650
  c   0.08015 0.10666 0.18681
  g   0.07961 0.10406 0.18367
  t   0.07882 0.10420 0.18302
  Sum 0.43065 0.56935 1.00000

-------------------------------------------------------------------------


        black   white     Sum
  a   0.01430 0.43183 0.44613
  c   0.13830 0.04581 0.18411
  g   0.13995 0.04541 0.18536
  t   0.13921 0.04519 0.18440
  Sum 0.43176 0.56824 1.00000

So the models are potentially identifiable!

#### 2023-03-14 RESEARCH LOG